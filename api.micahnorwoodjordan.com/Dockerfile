FROM maven:3.9-eclipse-temurin-17

ARG DATABASE_CONNECTION_STRING
ARG DATABASE_USER
ARG DATABASE_PASSWORD
ARG SPRING_PROFILES_ACTIVE
ARG SERVER_PORT

ENV DATABASE_CONNECTION_STRING=${DATABASE_CONNECTION_STRING}
ENV DATABASE_USER=${DATABASE_USER}
ENV DATABASE_PASSWORD=${DATABASE_PASSWORD}
ENV SPRING_PROFILES_ACTIVE=${SPRING_PROFILES_ACTIVE}
ENV SERVER_PORT=${SERVER_PORT}

COPY . /srv/api

WORKDIR /srv/api

RUN chmod +x ./mvnw && ./mvnw clean package

ENTRYPOINT [ "java -jar /srv/api/target/api.micahnorwoodjordan.com-build.jar" ]
